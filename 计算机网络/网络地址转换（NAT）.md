# 网络地址转换（NAT）
NAT是解决ipv4地址短缺的方案之一
NAT是将位于子网中的主机与外网连通，子网中所有的主机都可以通过路由器的网络地址转换访问外网。对于外网来说该路由器相当于一台完整的主机，子网内所有主机对外网的访问都被视作这台“主机”发出的访问。同样，外网对子网的主机的访问也是通过访问这个路由器实现的，对于外网而言，子网内部的主机是不可见的。
![20190725144415.png](https://raw.githubusercontent.com/zdzh/pothos/master/img/20190725144415.png)
路由器对网络地址转化是依靠NAT转换表实现的，上图中的S代表访问外网的主机的子网地址，路由器接受数据包后，将数据包的源地址改为路由器外网的ip地址，将源端口改为NAT表中未使用的端口，再将数据包发送给外网，外网服务器将响应按照路由器修改后的包中的地址返回给路由器，路由器对照NAT转换表修改包的目的地址和端口并将包转发给相应的主机。